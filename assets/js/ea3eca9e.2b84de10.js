"use strict";(self.webpackChunkdocumentacion=self.webpackChunkdocumentacion||[]).push([[4846],{3905:(e,a,n)=>{n.d(a,{Zo:()=>d,kt:()=>u});var t=n(7294);function o(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){o(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function i(e,a){if(null==e)return{};var n,t,o=function(e,a){if(null==e)return{};var n,t,o={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(o[n]=e[n]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=t.createContext({}),c=function(e){var a=t.useContext(l),n=a;return e&&(n="function"==typeof e?e(a):s(s({},a),e)),n},d=function(e){var a=c(e.components);return t.createElement(l.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},p=t.forwardRef((function(e,a){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=c(n),u=o,v=p["".concat(l,".").concat(u)]||p[u]||m[u]||r;return n?t.createElement(v,s(s({ref:a},d),{},{components:n})):t.createElement(v,s({ref:a},d))}));function u(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=p;var i={};for(var l in a)hasOwnProperty.call(a,l)&&(i[l]=a[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=n[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,n)}p.displayName="MDXCreateElement"},8785:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>l,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var t=n(7462),o=(n(7294),n(3905));const r={sidebar_position:4},s="MongoDB",i={unversionedId:"Node/mongo",id:"Node/mongo",title:"MongoDB",description:"- Es una base de datos que puede trabajar en la nube.",source:"@site/docs/Node/mongo.md",sourceDirName:"Node",slug:"/Node/mongo",permalink:"/documentacion/docs/Node/mongo",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Node/mongo.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"Node",previous:{title:"Router",permalink:"/documentacion/docs/Node/router"},next:{title:"Token y Practica API REST",permalink:"/documentacion/docs/Node/token"}},l={},c=[{value:"Pasos en el sitio web",id:"pasos-en-el-sitio-web",level:3},{value:"Mongoose",id:"mongoose",level:2},{value:"Schema",id:"schema",level:2},{value:"find()",id:"find",level:2},{value:"Varibles de entorno",id:"varibles-de-entorno",level:2},{value:"Configuracion",id:"configuracion",level:3},{value:"bodyParser",id:"bodyparser",level:2},{value:"Crear",id:"crear",level:2},{value:"Guardar/insertar documento - metodo 1:",id:"guardarinsertar-documento---metodo-1",level:3},{value:"Guardar/insertar documento - metodo 2:",id:"guardarinsertar-documento---metodo-2",level:3},{value:"Get \xfanico documento",id:"get-\xfanico-documento",level:2},{value:"Delete documento",id:"delete-documento",level:2},{value:"Editar documento",id:"editar-documento",level:2}],d={toc:c};function m(e){let{components:a,...n}=e;return(0,o.kt)("wrapper",(0,t.Z)({},d,n,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"mongodb"},"MongoDB"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Es una base de datos que puede trabajar en la nube."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.mongodb.com/"},"info")),(0,o.kt)("li",{parentName:"ul"},"Tiene un plan gratis."),(0,o.kt)("li",{parentName:"ul"},"Base de datos no relacional y que nos permite trabajar con la nube sin necesidad de hacer mayores instalaciones en nuestro equipo.")),(0,o.kt)("h3",{id:"pasos-en-el-sitio-web"},"Pasos en el sitio web"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://www.mongodb.com/"},"sitio web")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Nos regristamos (Que es gratis)"),(0,o.kt)("li",{parentName:"ol"},"Creamos nuestro Cluster")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Puedes dejar todo por defecto para que no exitan cargos monetarios en tu cuenta"),(0,o.kt)("li",{parentName:"ul"},"El plan gratuito est\xe1 limitado a un Cluster"),(0,o.kt)("li",{parentName:"ul"},"Pueden cambiar el nombre del Cluster.")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Esperar(crear el cluster lleva algunos minutos)"),(0,o.kt)("li",{parentName:"ol"},"Crear una coleccion(collection)",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"Le das a add my own data"),(0,o.kt)("li",{parentName:"ol"},"Nos pedira el nombre de la base de datos (en un cluster puede haber varias BD ojo)."),(0,o.kt)("li",{parentName:"ol"},"Nos pedir\xe1 el nombre de la colecci\xf3n  que seria como el nombre de una tabla")))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"En este ejemplo:"),(0,o.kt)("p",{parentName:"div"},"Nombre de BD: veterinaria"),(0,o.kt)("p",{parentName:"div"},"Nombre de colecci\xf3n: mascotas"))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Explicacion como si fuera una BD relacional")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Seria como a\xf1adir una tabla a la base de datos veterinaria, en este ejemplo se creo la colecci\xf3n (tabla) mascotas para almacenar los datos de las mascotas."),(0,o.kt)("li",{parentName:"ul"},"Una Base de datos puede tener muchas colecciones (tablas)")))),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"Seleccionamos la coleccion mascota"),(0,o.kt)("li",{parentName:"ol"},"Le damos a insert document")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Equivalente a a\xf1adir una fila a la tabla"),(0,o.kt)("li",{parentName:"ul"},"Cada fila es un objeto donde cada propiedad es como la columna de la tabla",(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},'{"_id":{"$oid":"620a5b245908e57941d2954c"},"nombre":"rex","descripcion":"descripcion de rex"}\n')))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Explicacion como si fuera una BD relacional")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"En una colecci\xf3n se guarda un conjunto de objetos(documentos)"),(0,o.kt)("li",{parentName:"ul"},"Los objetos pueden tener las mismas propiedades o diferentes."),(0,o.kt)("li",{parentName:"ul"},"En este caso ser\xe1 igual(recomendado) para mantener la consistencia."),(0,o.kt)("li",{parentName:"ul"},"Colecci\xf3n = Tabla"),(0,o.kt)("li",{parentName:"ul"},"Al insertar un documento = Insertar una fila "),(0,o.kt)("li",{parentName:"ul"},"Documento = fila"),(0,o.kt)("li",{parentName:"ul"},"La Fila = Es un objeto")))),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"Creamos un usuario")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Security \u2013 DataBase Access"),(0,o.kt)("li",{parentName:"ul"},"Creamos un usuario")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"ejemplo ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Usuario: usuarioVeterinaria"),(0,o.kt)("p",{parentName:"div"},"Contrase\xf1a: Thw7Mk9CpQXoEjvY"))),(0,o.kt)("ol",{start:8},(0,o.kt)("li",{parentName:"ol"},"Configurar el acceso a la BD(Firewall)")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"En Security \u2013 Acceso a la Red")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},"Conseguir una Uri ",(0,o.kt)("ol",{parentName:"li"},(0,o.kt)("li",{parentName:"ol"},"En Clusters/Base de datos  le das a Connect."),(0,o.kt)("li",{parentName:"ol"},"Connect your app (Conectarnos por la aplicaci\xf3n)."),(0,o.kt)("li",{parentName:"ol"},"Copiamos el String connection  y la ponemos en una variable const con la interpolaci\xf3n (en un archivo js)"),(0,o.kt)("li",{parentName:"ol"},"En el string remplazamos:")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," /*\n  <usuarioNOMBREBD> por un usuario que tenga acceso a la BD\n   <password> por la contrase\xf1a del usuario\n   <dbname> o myFirstDatabase por el nombre de la base de datos.\n */\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},' const user = "usuarioVeterinaria";\nconst password = "Thw7Mk9CpQXoEjvY";\nconst nombreBD = "veterinaria";\nconst uri = `mongodb+srv://${user}:${password}@mascota.xcibc.mongodb.net/${nombreBD}?retryWrites=true&w=majority`;\n')),(0,o.kt)("h2",{id:"mongoose"},"Mongoose"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Es una forma sencilla de establecer conexi\xf3n con MongoDB."),(0,o.kt)("li",{parentName:"ul"},"Se instala en node.js"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://mongoosejs.com/docs/index.html"},"info"))),(0,o.kt)("p",null,"Lo instalamos en el proyecto:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},"npm install mongoose\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Para conectarnos a una BD")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Necesitamos:"),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Un usuario"),(0,o.kt)("li",{parentName:"ul"},"Una contrase\xf1a"),(0,o.kt)("li",{parentName:"ul"},"Una uri  = Una url para establecer la conexion")))),(0,o.kt)("p",null,"Nos conectamos a la BD creada con la Uri:"),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"La uri la genera MongoDB , hay que buscarla en la configuraci\xf3n "))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'//index.js\n// Conexion a BD\nconst mongoose = require(\'mongoose\');\nconst user = "usuarioVeterinaria";\nconst password = "Thw7Mk9CpQXoEjvY";\nconst nombreBD = "veterinaria";\nconst uri = `mongodb+srv://${user}:${password}@mascota.xcibc.mongodb.net/${nombreBD}?retryWrites=true&w=majority`;\nmongoose.connect(uri)\n.then(() => console.log("Base de datos conectada"))\n.catch( e => {console.log(e)})\n\n')),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"seguridad ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Usamos variable de entorno  para ocultar la contrase\xf1a y el usuario."))),(0,o.kt)("h2",{id:"schema"},"Schema"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Se debe crear un esquema por cada colecci\xf3n(tabla) para poder especificar el nombre de cada propiedad y su tipo de valor(tipo de dato) para cada objeto."),(0,o.kt)("li",{parentName:"ul"},"Es para especificar la estructura de los documentos de la coleccion para luego poder manipular los objetos que contiene la colecci\xf3n a traves del modelo."),(0,o.kt)("li",{parentName:"ul"},"Si no se respeta la estructura  del esquema a la hora de crear un documento , se genera un error")),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"El modelo y el esquema no son lo mismo")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"esquema: Especifica la estructura de los documentos de la coleccion "),(0,o.kt)("li",{parentName:"ul"},"modelo: Se crea a partir del esquema y contiene los metodos para manipular la coleccion (leer , borrar , modificar , crear)")))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"En el proyecto generamos una carpeta llamada models"),(0,o.kt)("li",{parentName:"ol"},"En dicha carpetamos , creamos mascota.js donde va a contener el esquema.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Se hace un esquema (por lo tanto, un nuevo archivo.js) por cada colecci\xf3n.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// models/mascota.js\nconst mongoose = require('mongoose');\nconst    { Schema } = mongoose;\n// Definiendo el esquema:\n//El esquema es una nueva instancia de Schema\n// new Schema({ campos del documentos})\nconst mascotaSchema = new Schema({\n\n    // nombre de propiedad : tipo de valor ,  nombre de propiedad : tipo de valor\n    // Como la ID se genera sola, no se especifica\n    nombre: String ,\n    descripcion: String\n})\n\n// Creamos el modelo de mascota \n// model(nombre del modelo/coleccion , esquema)\nconst Mascota = mongoose.model('Mascota' ,mascotaSchema );\n\n// Exportamos el modelo\n\nmodule.exports = Mascota;\n\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"En la carpeta router/Mascota.js")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// router/Mascota.js\nconst express = require('express');\nconst router = express.Router();\n // Importamos el modelo\n const Mascota = require('../models/mascota');\n\n")),(0,o.kt)("h2",{id:"find"},"find()"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Es un metodo del modelo"),(0,o.kt)("li",{parentName:"ul"},"Sirve para leer una colecci\xf3n que contiene varios documentos."),(0,o.kt)("li",{parentName:"ul"},"Trae los documentos de una colecci\xf3n."),(0,o.kt)("li",{parentName:"ul"},"La funci\xf3n la implementa un modelo.")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"recordatorio  ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"El nombre del modelo es el nombre de la coleccion")))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Al trabajar con una BD, utilizamos funciones async await para implementarla."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://mongoosejs.com/docs/api.html#model_Model.find"},"mas info"))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Equivalencia a BD relacionales")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Es como hacer un Select ",(0,o.kt)("em",{parentName:"li"}," from tabla  (donde tabla es el nombre del modelo Ej. select ")," from nombreModelo)"),(0,o.kt)("li",{parentName:"ul"},"Donde la tabla es la colecci\xf3n"),(0,o.kt)("li",{parentName:"ul"},"Y los resultados(filas) que genera la consulta , los guarda en un array.")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// router/Mascota.js\nconst express = require('express');\nconst router = express.Router();\n // Importamos el esquema\n const Mascota = require('../models/mascota');\nrouter.get('/', async (req, res) => {\n    try {\n        // Busca la coleccion de mascota y nos devuelve todos sus documentos.\n        const arrayMascotasBD =  await Mascota.find();\n        console.log(arrayMascotasBD);\n         // listaMascotas = Array\n    res.render(\"mascotas\", { listaMascotas: arrayMascotasBD}\n\n     )\n    } \n    catch(e) {\n       console.log(e);\n    }\n    \n\n   \n})\n\nmodule.exports = router;\n\n")),(0,o.kt)("h2",{id:"varibles-de-entorno"},"Varibles de entorno"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Son para ocultar informaci\xf3n sensible."),(0,o.kt)("li",{parentName:"ul"},"Se configuran en el servidor."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/dotenv"},"Utilizamos este modulo")," ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},"npm install dotenv\n")),(0,o.kt)("h3",{id:"configuracion"},"Configuracion"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Importalo")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"require('dotenv').config()\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Crear archivo .env ")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Si se desea cambiar el  nombre del archivo, se deber\xe1 configurar el path (ver documentacion)"),(0,o.kt)("li",{parentName:"ul"},"En este archivo van las variables de entorno"),(0,o.kt)("li",{parentName:"ul"},"Le pod\xe9s asignar un valor (PORT = 3001) o dejar que el hosting le asigne un valor (USUARIO = xxx)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-env"},"PORT=3001\nUSUARIO=xxx\nPASSWORD=xxx\nDBNAME=xxx\n\n")),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Las variables de entorno se generan y configuran en el hosting"))),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Para acceder a una variable de entorno:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"process.env.NOMBREVARIABLE\n")),(0,o.kt)("p",null,"Ejemplo: En un entorno local"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// index.js\nconst express = require(\"express\");\nvar path = require('path');\nconst app = express();\n\nrequire('dotenv').config()\nconst port = process.env.PORT || 3000\n\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-env"},"PORT=3001\n")),(0,o.kt)("p",null,"Otro Ejemplo: "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-env"},"PORT=3001\nUSER=usuarioVeterinaria\nPASSWORD=Thw7Mk9CpQXoEjvY\nBD=veterinaria\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"\n//index.js\n// Conexion a BD\nconst mongoose = require('mongoose');\nconst uri = `mongodb+srv://${process.env.USER}:${process.env.PASSWORD}@mascota.xcibc.mongodb.net/${process.env.BD}?retryWrites=true&w=majority`;\nmongoose.connect(uri)\n\n")),(0,o.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Todos esos Ejemplos tienen las variables de entorno en un entorno local (est\xe1n ubicada en nuestra PC)."),(0,o.kt)("li",{parentName:"ul"},"el archivo .env se debe ignorar junto con el node_modules en git.")))),(0,o.kt)("p",null,"Ejemplo en un entorno de producci\xf3n (subido a un hosting):"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Se crean las variables (como si fuera un .env) en el hosting (Configurar el hosting)"),(0,o.kt)("li",{parentName:"ol"},"el index.js sigue igual , no se modifica")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"//index.js\n// Conexion a BD\nconst mongoose = require('mongoose');\nconst uri = `mongodb+srv://${process.env.USER}:${process.env.PASSWORD}@mascota.xcibc.mongodb.net/${process.env.BD}?retryWrites=true&w=majority`;\nmongoose.connect(uri)\n\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Se sube el proyecto al hosting ignorando el archivo.env ")),(0,o.kt)("h2",{id:"bodyparser"},"bodyParser"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Lo Tenemos que instalar para utilizar x-www-form-urlencoded"),(0,o.kt)("li",{parentName:"ul"},"Sirve para leer el formulario (Leer el cuerpo del body)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/body-parser"},"modulo"))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Lo instalamos:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-powershell"},"npm i body-parser\n")),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Lo configuramos ")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// index.js\nconst express = require(\"express\");\n// Importamos bodyParser\nconst  bodyParser = require('body-parser')\nvar path = require('path');\nconst app = express();\n// Lo configuramos\n// parse application/x-www-form-urlencoded\napp.use(bodyParser.urlencoded({ extended: false }))\n// parse application/json\napp.use(bodyParser.json())\nrequire('dotenv').config()\nconst port = process.env.PORT || 3000\n\n")),(0,o.kt)("h2",{id:"crear"},"Crear"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Creamos el archivo crear.ejs en la carpeta de vistas")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Los name de los inputs deben coincidir con el nombre de las propiedades del documento(objeto) a crear(MONGODB)"),(0,o.kt)("li",{parentName:"ul"},"Para ver si coincidi eso , busca en el esquema")),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const mascotaSchema = new Schema({\n\n    // nombre de propiedad : tipo de valor ,  nombre de propiedad : tipo de valor\n    // Como la ID se genera sola, no se especifica\n    nombre: String ,\n    descripcion: String\n})\n\n")),(0,o.kt)("p",{parentName:"div"},"Como se puede ver en el esquema hay dos propiedades , nombre y descripci\xf3n."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'<%- include("template/cabecera" , {title : "Crear nuevo mascota"})   %>\n\n    <div class="container">\n        <h1>Crear</h1>\n        <form action="/mascotas" method="POST">\n         <input\n           type="text"\n           placeholder="Agregar nombre"\n           class="form-control my-2"\n           name="nombre">\n            <input\n           type="text"\n           placeholder="Agregar descripcion"\n           class="form-control my-2" \n           name="descripcion">\n           <div class="d-grid gap-2">\n            <button class="btn btn-success" type="submit">Agregar</button>\n          \n          </div>\n         \n          </div>\n        </form>\n    </div>\n    <%- include("template/footer")    %>\n\n')),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"mascotas.ejs")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'\x3c!-- views/mascotas.ejs --\x3e\n<%- include("template/cabecera" , {title: "titulo"})    %>\n <div class="container">\n   <h1>Crud Mongo</h1>\n  <div class="d-grid gap-2">\n    <a type="button" class="btn btn-success  my4" href="mascotas/crear">Crear nueva mascota</a>\n    </div>\n    <table class="table">\n        <thead>\n          <tr>\n            <th scope="col">#</th>\n            <th scope="col">Nombre</th>\n            <th scope="col">Descripcion</th>\n            <th scope="col">Accion</th>\n          </tr>\n        </thead>\n        <tbody>\n            <% if (listaMascotas.length > 0) { %>\n              \n                <% listaMascotas.forEach(mascota => { %>\n                    <tr>\n                        <th scope="row"><%= mascota.id  %> </th>\n                        <td><%= mascota.nombre  %> </td>\n                        <td><%= mascota.descripcion  %> </td>\n                        <td>@mdo</td>\n                    </tr>\n                <% }) %> \n        \n            <% } %>\n       \n          \n        </tbody>\n      </table>\n   \n   \n </div>\n\n<%- include("template/footer")    %>\n\n')),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Ahora vamos a trabajar con el verbo POST"),(0,o.kt)("li",{parentName:"ul"},"Nos permite recibir informaci\xf3n ")))),(0,o.kt)("p",null,"router/Mascota.js"),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"La informaci\xf3n se recibe por el body del requerimiento."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Mascota.js \nrouter.get(\"/crear\" , (req, res) => {\n    res.render('crear');\n})\n\nrouter.post('/' , async(req,res) => {\n    const body = req.body;\n    console.log(body);\n})\n\nmodule.exports = router;\n\n")),(0,o.kt)("h3",{id:"guardarinsertar-documento---metodo-1"},"Guardar/insertar documento - metodo 1:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://mongoosejs.com/docs/models.html"},"info"))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Observacion ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"La nueva instancia del modelo contiene el documento que se va a guardar"),(0,o.kt)("li",{parentName:"ul"},"Lo que recibe en el momento de la instancia es el documento(objeto) que se va a  crear/insertar en la BD"),(0,o.kt)("li",{parentName:"ul"},"La instancia tiene acceso al metodo save() para guardarse en la BD"),(0,o.kt)("li",{parentName:"ul"},"el metodo save() crea la coleccion (si no existe) y el documento")))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Se crea utilizando el modelo"),(0,o.kt)("p",{parentName:"div"},"Si no se respeta la estructura del  esquema cuando se crea el objeto , se genera un error"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"}," const Mascota = require('../models/mascota');\nrouter.post('/' , async(req,res) => {\n    const body = req.body;\n    try {\n        // Creamos el documento/objeto\n        // const variable = new nombreesquema(objeto/documento)\n       const mascotaDB = new Mascota(body);\n       // Lo guardamos en la base de datos\n       await mascotaDB.save();\n    } catch(e) {\n        console.log(e)\n    }\n    console.log(body);\n})\n\n")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"usamos redirect(\u201cruta\u201d) para direccionar a otra ruta."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"router.post('/' , async(req,res) => {\n    const body = req.body;\n    try {\n        // Creamos el documento/objeto\n        // const variable = new nombreesquema(objeto/documento)\n       const mascotaDB = new Mascota(body);\n       // Lo guardamos en la base de datos\n       await mascotaDB.save();\n       res.redirect(\"/mascotas\");\n    } catch(e) {\n        console.log(e)\n    }\n    \n})\n\n")),(0,o.kt)("h3",{id:"guardarinsertar-documento---metodo-2"},"Guardar/insertar documento - metodo 2:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Se crea utilizando el modelo:"),(0,o.kt)("li",{parentName:"ul"},"Se crea y se guarda en la misma l\xednea.")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Observacion ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Se utiliza el modelo y no una instancia de el."),(0,o.kt)("li",{parentName:"ul"},"Lo que recibia la nueva instancia del modelo ( ejemplo anterior) , lo recibe el metodo create()")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"router.post('/' , async(req,res) => {\n    const body = req.body;\n    try {\n    // Lo creamos y lo guardamos\n\n        // Creamos el documento/objeto en MongoDB\n        // create(objeto/documento)\n     await Mascota.create(body)\n      \n       res.redirect(\"/mascotas\");\n    } catch(e) {\n        console.log(e)\n    }\n    \n})\n\n")),(0,o.kt)("h2",{id:"get-\xfanico-documento"},"Get \xfanico documento"),(0,o.kt)("p",null,"router/Mascota.js"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Utilizamos una url din\xe1mica"),(0,o.kt)("li",{parentName:"ul"},'Implem\xe9ntamos en la ruta  ":nombrevariable"')),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Observacion ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"el metodo findOne lo contiene el modelo no la instancia"),(0,o.kt)("li",{parentName:"ul"},"el metodo findOne Devuelve una instancia del modelo con el documento seleccionado.")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"\n//  \"/:nombrevariable\"\n//la ruta es /mascotas/nombrevariable\n// Ejemplo: http://localhost:3001/mascotas/620a5b245908e57941d2954c\n// El valor de nombrevariable es 620a5b245908e57941d2954c\nrouter.get('/:id' , async(req, res) => {\n   try {\n       // req.params.nombrevariable para obtener el valor de dicha variable\n       const id = req.params.id;\n       // Buscamos la primera mascota que _id sea igual a la const id.\n       // select * from Mascota(nombreModelo) where _id == id;\n       const mascotaDB = await Mascota.findOne({_id : id})\n       res.render('detalle' ,  {mascota: mascotaDB , error:false})\n   } catch (error) {\n    res.render('detalle' ,  {error:true , mensaje: \"No se encuentra el id seleccionado\"})\n   }\n})\nmodule.exports = router;\n\n")),(0,o.kt)("p",null,"views/detalle.ejs"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'<%- include("template/cabecera" , {title : "Detalle de mascota" }) %>\n\n    <div class="container">\n        <h1>Detalle Mascota</h1>\n        <% if (error) { %>\n            <p>\n                <%= mensaje %>\n            </p>\n            <div class="d-grid gap-2">\n                <a href="/mascotas" class="btn btn-dark ">Volver a Mascotas</a>\n            </div>\n            <% } %>\n                <% if (!error) { %>\n                    <table class="table">\n                        <thead>\n                            <tr>\n                                <th scope="col">#</th>\n                                <th scope="col">Nombre</th>\n                                <th scope="col">Descripcion</th>\n                                <th scope="col">Accion</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n\n\n                            <tr>\n                                <th scope="row">\n                                    <%= mascota.id %>\n                                </th>\n                                <td>\n                                    <%= mascota.nombre %>\n                                </td>\n                                <td>\n                                    <%= mascota.descripcion %>\n                                </td>\n                                <td>@mdo</td>\n                            </tr>\n\n\n\n\n                        </tbody>\n                    </table>\n\n                    <% } %>\n    </div>\n    <%- include("template/footer") %>\n\n')),(0,o.kt)("p",null,"views/mascotas.ejs"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'\n\x3c!-- views/mascotas.ejs --\x3e\n<%- include("template/cabecera" , {title: "titulo"})    %>\n <div class="container">\n   <h1>Crud Mongo</h1>\n  <div class="d-grid gap-2">\n    <a type="button" class="btn btn-success  my4" href="mascotas/crear">Crear nueva mascota</a>\n    </div>\n    <table class="table">\n        <thead>\n          <tr>\n            <th scope="col">#</th>\n            <th scope="col">Nombre</th>\n            <th scope="col">Descripcion</th>\n            <th scope="col">Accion</th>\n          </tr>\n        </thead>\n        <tbody>\n            <% if (listaMascotas.length > 0) { %>\n              \n                <% listaMascotas.forEach(mascota => { %>\n                    <tr>\n                        <th scope="row"><%= mascota.id  %> </th>\n                        <td><%= mascota.nombre  %> </td>\n                        <td><%= mascota.descripcion  %> </td>\n                        <td> <a href="mascotas/<%= mascota.id  %>" class="btn btn-warning btn-sm">Editar</a></td>\n                    </tr>\n                <% }) %> \n        \n            <% } %>\n       \n          \n        </tbody>\n      </table>\n   \n   \n </div>\n\n<%- include("template/footer")    %>\n\n')),(0,o.kt)("h2",{id:"delete-documento"},"Delete documento"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Vamos a usar el verbo http Delete para eliminar."),(0,o.kt)("li",{parentName:"ul"},"Una petici\xf3n delete se crea por el m\xe9todo fetch ya que el formulario HTML no lo envia."),(0,o.kt)("li",{parentName:"ul"},"Vamos a hacer una respuesta en json")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Observacion ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"el metodo findByIdAndDelete lo contiene el modelo no la instancia")))),(0,o.kt)("p",null,"router/Mascota.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// mascotas/valordelavariableid\nrouter.delete(\'/:id\' , async(req , res) =>  {\n    const id = req.params.id;\n    try {\n        // Buscamos la mascota por la _id y lo eliminamos\n          // Si se elimina correctamente devuelve el documento que se borro\n          // delete  from Mascota(nombreModelo) where _id = id\n        const mascotaDB = await Mascota.findByIdAndDelete({_id : id});\n      \n        if (mascotaDB) {\n               // respuesta en json \n               res.json( { estado : true , mensaje: "eliminado!"})\n        } else {\n              // respuesta en json\n              res.json({estado: false ,mensaje: "fallo al eliminar!"})\n        }\n    } catch (error) {\n         console.log(error)\n    }\n})\nmodule.exports = router;\n\n')),(0,o.kt)("p",null,"views/detalle.ejs"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'\n<%- include("template/cabecera" , {title : "Detalle de mascota" }) %>\n\n    <div class="container">\n        <h1>Detalle Mascota</h1>\n        <% if (error) { %>\n            <p>\n                <%= mensaje %>\n            </p>\n            <div class="d-grid gap-2">\n                <a href="/mascotas" class="btn btn-dark ">Volver a Mascotas</a>\n            </div>\n            <% } %>\n                <% if (!error) { %>\n                    <table class="table">\n                        <thead>\n                            <tr>\n                                <th scope="col">#</th>\n                                <th scope="col">Nombre</th>\n                                <th scope="col">Descripcion</th>\n                                <th scope="col">Accion</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n\n\n                            <tr>\n                                <th scope="row">\n                                    <%= mascota.id %>\n                                </th>\n                                <td>\n                                    <%= mascota.nombre %>\n                                </td>\n                                <td>\n                                    <%= mascota.descripcion %>\n                                </td>\n                                <td> <button  id="btnEliminar" class="btn btn-danger btn-sm" data-id="<%= mascota.id %>">Eliminar</button></td>\n                            </tr>\n\n\n\n\n                        </tbody>\n                    </table>\n\n                    <% } %>\n    </div>\n    <%- include("template/footer") %>\n    <script>\n      const btnEliminar = document.getElementById("btnEliminar");\n     btnEliminar.addEventListener("click", async () => {\n         const id = btnEliminar.dataset.id;\n         try {\n             // Enviamos una solicitud delete por fetch (Si no especificamos que es delete se hace get)\n             const data = await fetch(`/mascotas/${id}` , {method: \'delete\'});\n             const res = await data.json();\n             if (res.estado) {\n                //  Rediccionamos\n                 window.location.href = "/mascotas"\n             } else {\n                 console.log(res);\n             }\n         } catch (error) {\n             console.log(error)\n         }\n     })\n\n    <\/script>\n\n')),(0,o.kt)("h2",{id:"editar-documento"},"Editar documento"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Utilizamos el metodo http put que generalmente se usa para modificar."),(0,o.kt)("li",{parentName:"ul"},"Vamos a utilizar el body del requirimiento por lo tanto hacer los arreglos necesarios (ver el apartado de bodyparser)"),(0,o.kt)("li",{parentName:"ul"},"El form (HTML) solo soporta GET Y POST . Por lo tanto para usar put vamos a usar javascript(fetch) , igual que como Delete.")),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Observacion ")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"el metodo findByIdAndUpdate lo contiene el modelo no la instancia")))),(0,o.kt)("p",null,"router/Mascota.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'router.put(\'/:id\' , async(req,res) => {\n    const id = req.params.id;\n    const body = req.body;\n    try {\n        // Encontrar la mascota y modificarla\n        // Parametros findByIdAndUpdate(id a buscar , los datos nuevos , una opcion para evitar un warning)\n         // devuelve el documento modificado\n         // UPDATE Mascota(nombreModelo) SET propiedad nombre = valor de propiedad nombre , propiedad descripcion = valor de propiedad descripcion    WHERE  _id = id a buscar; \n         // las propiedades nombre y descripcion se encuentran en el body (segundo parametro)(es un objeto)\n       const mascotaBD = await Mascota.findByIdAndUpdate(id , body , {useFindAndModify: false});\n      \n       res.json({estado: true , mensaje:"Editado"});\n    } catch (error) {\n        console.log(error)\n        res.json({estado: false , mensaje:"Fallamos"});\n    }\n})\nmodule.exports = router;\n\n')),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Como es para manipular una BD usamos una funci\xf3n async await"),(0,o.kt)("li",{parentName:"ul"},"Para leer el body tmb debe estar configurado el bodyParser para JSON")))),(0,o.kt)("p",null,"detalle.ejs"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'<%- include("template/cabecera" , {title : "Detalle de mascota" }) %>\n\n    <div class="container">\n        <h1>Detalle Mascota</h1>\n        <% if (error) { %>\n            <p>\n                <%= mensaje %>\n            </p>\n            <div class="d-grid gap-2">\n                <a href="/mascotas" class="btn btn-dark ">Volver a Mascotas</a>\n            </div>\n            <% } %>\n                <% if (!error) { %>\n                    <form action="" id="formEditar" data-id="<%= mascota.id %>">\n                        <input\n                        type="text"\n                        placeholder="Agregar nombre"\n                        class="form-control my-2"\n                        name="nombre" \n                        value = " <%= mascota.nombre %>"\n                        id="nombreInput">\n                         <input\n                        type="text"\n                        placeholder="Agregar descripcion"\n                        class="form-control my-2" \n                        name="descripcion"\n                        value = " <%= mascota.descripcion %>"\n                        id="descripcionInput">\n                        <div class="d-grid gap-2">\n                         <button class="btn btn-warning" type="submit" >Editar</button>\n                        </div>\n                    </form>\n                    <button  id="btnEliminar" class="btn btn-danger btn-sm mt-5" data-id="<%= mascota.id %>" type="submit">Eliminar</button>\n                   \n\n                    <% } %>\n  \n    <%- include("template/footer") %>\n    <script>\n      const btnEliminar = document.getElementById("btnEliminar");\n     btnEliminar.addEventListener("click", async () => {\n         const id = btnEliminar.dataset.id;\n         try {\n             // Enviamos una solicitud delete por fetch (Si no especificamos que es delete se hace get)\n             const data = await fetch(`/mascotas/${id}` , {method: \'delete\'});\n             const res = await data.json();\n             if (res.estado) {\n                //  Rediccionamos\n                 window.location.href = "/mascotas"\n             } else {\n                 console.log(res);\n             }\n         } catch (error) {\n             console.log(error)\n         }\n     })\n     const formularioEditar = document.getElementById("formEditar");\n\n     formularioEditar.addEventListener(\'submit\' , async (e) => {\n         e.preventDefault();\n         // Seleccionamos el input que contiene el nombre a traves de su atributo name\n         //elements[\'valordelatributoname\']\n         const nombre = formularioEditar.elements[\'nombre\'].value;\n         const descripcion = document.querySelector(\'#descripcionInput\').value;\n         const id = formularioEditar.dataset.id;\n         console.log(nombre , descripcion , id);\n         try {\n             // En el fetch enviamos informacion(JSON) a traves del body\n            const data = await fetch(`/mascotas/${id}` , {method: \'put\' , \n                headers: {\n                    //Le indicamos que vamos a mandar un JSON\n                    \'Content-Type\': \'application/json\'\n                } , \n                body: JSON.stringify({\n                //Enviamos un JSON a traves del body\n                // nombre = const nombre \n                //descripcion = const descripcion\n                // Si la propiedad y el valor tienen el mismo nombre, no hace falta especificar el valor\n                nombre , descripcion\n            }) });\n            const res = await data.json();\n            if (res.estado) {\n                 //  Rediccionamos\n                 window.location.href = "/mascotas"\n            } else {\n                console.log(res)\n            }\n         }catch (e) {\n             console.log(e)\n         }\n     }) \n    <\/script>\n\n')))}m.isMDXComponent=!0}}]);